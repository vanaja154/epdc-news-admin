<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPDC</title>
    <script src="https://kit.fontawesome.com/109a493327.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="header.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
    <style>
        .vertical-line {
            border-left: 2px solid #ddd;
            height: 582%;
            position: absolute;
            left: 40%;
            top: 49px;
        }
        .bold-line {
            border: none;
            height: 2px;
            background-color: black;
            margin: 20px 0;
        }
        .row {
            display: flex;
        }
        .btn-primary{
            margin-top: 20px;
            margin-bottom: 20px;
        }
        label{
            font-weight: bold;
        }
    </style>
</head>
<body>
<div th:replace="~{header :: header}"></div>

<div class="container mt-4 row">
    <!-- Left Side: Input Forms -->
    <div class="col-md-6">
        <h3>Latest News</h3>

        <!-- Single Form for All Updates -->
        <form id="updateForm" method="post" enctype="multipart/form-data">
            <!-- Left Side 1st Image -->
            <label class="form-label">Left Side 1st Image</label>
            <input type="file" class="form-control" name="leftImage1" accept="image/*" />
            <button type="button" onclick="submitForm('leftImage1')" class="btn btn-primary">Update</button>
            <!-- <hr class="bold-line"> -->
             <div></div>

            <!-- Left Side 1st Text -->
            <label class="form-label">Left Side 1st Text</label>
            <textarea class="form-control" name="leftText1"></textarea>
            <button type="button" onclick="submitForm('leftText1')" class="btn btn-primary">Update</button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Left Side 2nd Image -->
            <label class="form-label">Left Side 2nd Image</label>
            <input type="file" class="form-control" name="leftImage2" accept="image/*" />
            <button type="button" onclick="submitForm('leftImage2')" class="btn btn-primary">Update </button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Left Side 2nd Text -->
            <label class="form-label">Left Side 2nd Text</label>
            <textarea class="form-control" name="leftText2"></textarea>
            <button type="button" onclick="submitForm('leftText2')" class="btn btn-primary">Update</button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Left Side 3rd Image -->
            <label class="form-label">Left Side 3rd Image</label>
            <input type="file" class="form-control" name="leftImage3" accept="image/*" />
            <button type="button" onclick="submitForm('leftImage3')" class="btn btn-primary">Update </button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Left Side 3rd Text -->
            <label class="form-label">Left Side 3rd Text</label>
            <textarea class="form-control" name="leftText3"></textarea>
            <button type="button" onclick="submitForm('leftText3')" class="btn btn-primary">Update </button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Video 1 -->
            <label class="form-label">Video 1</label>
            <input type="file" class="form-control" name="video1" accept="video/*" />
            <button type="button" onclick="submitForm('video1')" class="btn btn-primary">Update </button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Video 2 -->
            <label class="form-label">Video 2</label>
            <input type="file" class="form-control" name="video2" accept="video/*" />
            <button type="button" onclick="submitForm('video2')" class="btn btn-primary">Update </button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Video 2 Text -->
            <label class="form-label">Video 2 Text</label>
            <textarea class="form-control" name="videoText2"></textarea>
            <button type="button" onclick="submitForm('videoText2')" class="btn btn-primary">Update </button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Video 3 -->
            <label class="form-label">Video 3</label>
            <input type="file" class="form-control" name="video3" accept="video/*" />
            <button type="button" onclick="submitForm('video3')" class="btn btn-primary">Update </button>
            <!-- <hr class="bold-line"> -->
            <div></div>

            <!-- Video 3 Text -->
            <label class="form-label">Video 3 Text</label>
            <textarea class="form-control" name="videoText3"></textarea>
            <button type="button" onclick="submitForm('videoText3')" class="btn btn-primary">Update </button>
            <!-- <hr class="bold-line"> -->
            <div></div>
        </form>
    </div>

    <!-- Right Side: Display Data -->
    <div class="col-md-6">
        <h3>Latest News</h3>

        <!-- Left Side 1st Image -->
        <div>
            <strong>Left Side 1st Image:</strong>
            <img th:if="${secondSection.leftImage1}" th:src="@{${'/uploads/' + secondSection.leftImage1}}" alt="Left Image 1" width="100"/>
        </div>
        <div>
            <strong>Left Side 1st Text:</strong>
            <p th:text="${secondSection.leftText1}"></p>
        </div>
        <hr/>

        <!-- Left Side 2nd Image -->
        <div>
            <strong>Left Side 2nd Image:</strong>
            <img th:if="${secondSection.leftImage2}" th:src="@{${'/uploads/' + secondSection.leftImage2}}" alt="Left Image 2" width="100"/>
        </div>
        <div>
            <strong>Left Side 2nd Text:</strong>
            <p th:text="${secondSection.leftText2}"></p>
        </div>
        <hr/>

        <!-- Left Side 3rd Image -->
        <div>
            <strong>Left Side 3rd Image:</strong>
            <img th:if="${secondSection.leftImage3}" th:src="@{${'/uploads/' + secondSection.leftImage3}}" alt="Left Image 3" width="100"/>
        </div>
        <div>
            <strong>Left Side 3rd Text:</strong>
            <p th:text="${secondSection.leftText3}"></p>
        </div>
        <hr/>

        <!-- Video 1 -->
        <div>
            <strong>Video 1:</strong>
            <video th:if="${secondSection.video1}" controls width="200">
                <source th:src="@{${'/uploads/' + secondSection.video1}}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <hr/>

        <!-- Video 2 -->
        <div>
            <strong>Video 2:</strong>
            <video th:if="${secondSection.video2}" controls width="200">
                <source th:src="@{${'/uploads/' + secondSection.video2}}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <div>
            <strong>Video 2 Text:</strong>
            <p th:text="${secondSection.videoText2}"></p>
        </div>
        <hr/>

        <!-- Video 3 -->
        <div>
            <strong>Video 3:</strong>
            <video th:if="${secondSection.video3}" controls width="200">
                <source th:src="@{${'/uploads/' + secondSection.video3}}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <div>
            <strong>Video 3 Text:</strong>
            <p th:text="${secondSection.videoText3}"></p>
        </div>
        <hr/>
    </div>
</div>

<script>
    function submitForm(fieldName) {
        const form = document.getElementById('updateForm');
        const formData = new FormData(form);

        // Check if the field has a value
        const fieldValue = formData.get(fieldName);
        if (!fieldValue || (fieldValue instanceof File && fieldValue.size === 0)) {
            alert('Please select a file or enter text before updating.');
            return; // Stop execution if the field is empty
        }

        // Only include the field being updated
        const data = new FormData();
        data.append(fieldName, fieldValue);

        // Submit the form data to the backend
        fetch('/updateSecondSection', {
            method: 'POST',
            body: data,
        }).then(response => {
            if (response.ok) {
                alert('Updated successfully!');
                location.reload(); // Reload the page to reflect changes
            } else {
                alert('Failed to update.');
            }
        });
    }

</script>
</body>
</html>